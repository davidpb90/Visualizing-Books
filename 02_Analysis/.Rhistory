#trial <- str_split(adventures," ")
trial <- str_replace_all(adventures,"[^[:alpha:]| ]"," ") %>%
str_split(" ") %>%
sapply(function(words){return(words[words!=""])}) #%>%
trial
trial[1]
#trial <- str_split(adventures," ")
trial <- str_replace_all(adventures,"[^[:alpha:]| ]"," ") %>%
str_split(" ") %>%
sapply(function(words){return(words[words!=""])},simplify = "array") #%>%
trial
#trial <- str_split(adventures," ")
trial <- str_replace_all(adventures,"[^[:alpha:]| ]"," ") %>%
str_split(" ") #%>%
trial
trial[1]
trial[2]
#trial <- str_split(adventures," ")
trial <- str_replace_all(adventures,"[^[:alpha:]| ]"," ") #%>%
trial
lapplay(str_split(" ")) #%>%
#trial <- str_split(adventures," ")
trial <- str_replace_all(adventures,"[^[:alpha:]| ]"," ") %>%
lapplay(str_split(" ")) #%>%
#trial <- str_split(adventures," ")
trial <- str_replace_all(adventures,"[^[:alpha:]| ]"," ") %>%
lapply(str_split(" ")) #%>%
#trial <- str_split(adventures," ")
trial <- str_replace_all(adventures,"[^[:alpha:]| ]"," ") %>%
lapply(str_split(.," ")) #%>%
#trial <- str_split(adventures," ")
trial <- str_replace_all(adventures,"[^[:alpha:]| ]"," ") %>%
lapply(function(line){return(str_split(line," ")})) #%>%
#trial <- str_split(adventures," ")
trial <- str_replace_all(adventures,"[^[:alpha:]| ]"," ") %>%
lapply(function(line){return(str_split(line," "))}) #%>%
trial
#trial <- str_split(adventures," ")
trial <- str_replace_all(adventures,"[^[:alpha:]| ]"," ") %>%
str_split(" ") #%>%
trial
trial[1]
clean[1]<-trial[1][[1]]
clean<-trial[1][[1]]
clean
lapply(trial,function(line){return(line[[1]])})
trial
trial[1]
trial[2]
trial[2][[1]]
#as.tibble(names=c("lines"))
line<-function(line)(return(line[[1]]))
line(trial[1])
sapply(trial,function(line){return(line[[1]])},simplfy = "array")
sapply(trial,function(line){return(line[[1]])},simplify = "array")
sapply(trial,function(line){return(line[[1]])},simplify = "vector")
sapply(trial,function(line){return(line[[1]])},simplify = "matrix")
trial
lapply(trial,function(line){return(line[[1]])})
vapply(trial,function(line){return(line[[1]])})
trial
trial[[1]]
trial[[2]]
trial[1]
line(trial[1])
apply(trial,function(line){return(line[[1]])})
lapply(trial,function(line){return(line[[1]])})
trial[[1]]
library(tidyr)
unnest(trial)
trial
data_frame(trial)
unnest(data_frame(trial))
trial
trial[1,]
trial[1]
class(trial)
class(trial[1])
class(trial[[1]])
trial[[1]]
#as.tibble(names=c("lines"))
line<-function(line)(return(list(line[[1]])))
line(trial[1])
lapply(trial,function(line){return(line[[1]])})
trial
#as.tibble(names=c("lines"))
line<-function(line)(return(list(line[1])))
lapply(trial,function(line){return(line[[1]])})
adventures <- read_lines("https://ia800501.us.archive.org/27/items/theadventuresofs01661gut/pg1661.txt", skip = 65)
adventures <- read_lines("https://ia800501.us.archive.org/27/items/theadventuresofs01661gut/pg1661.txt", skip = 65)
adventures
text_df <- data_frame(line = 1:length(adventures), text = adventures)
text_df
text_df %>%
unnest_tokens(word, text)
library(tidytext)
install.packages("tidytext")
library(tidytext)
text_df %>%
unnest_tokens(word, text)
tidy_book <- adventures %>%
mutate(linenumber = row_number(),chapter = cumsum(str_detect(text, regex("^chapter [\\divxlc]",ignore_case = TRUE))))
adventures
tidy_book <- adventures %>%
data_frame() %>%
mutate(linenumber = row_number(),chapter = cumsum(str_detect(text, regex("^chapter [\\divxlc]",ignore_case = TRUE))))
tidy_book <- adventures %>%
data_frame() #%>%
tidy_book
tidy_book <- adventures %>%
data_frame(text=.) #%>%
tidy_book
tidy_book <- adventures %>%
data_frame(text=.) %>%
mutate(linenumber = row_number(),chapter = cumsum(str_detect(text, regex("^chapter [\\divxlc]",ignore_case = TRUE))))
tidy_book
unique(tidy_book$chapter)
tidy_book <- adventures %>%
data_frame(text=.) %>%
mutate(linenumber = row_number(),chapter = cumsum(str_detect(text, regex("^ADVENTURE",ignore_case = TRUE))))
unique(tidy_book$chapter)
tidy_book
data(stop_words)
tidy_books <- tidy_books %>%
anti_join(stop_words)
tidy_book <- tidy_books %>%
anti_join(stop_words)
tidy_book <- tidy_book %>%
anti_join(stop_words)
tidy_book
tidy_book <- adventures %>%
data_frame(text=.) %>%
mutate(linenumber = row_number(),chapter = cumsum(str_detect(text, regex("^ADVENTURE",ignore_case = TRUE)))) %>%
unnest_token(word,text)
library(tidytext)
tidy_book <- adventures %>%
data_frame(text=.) %>%
mutate(linenumber = row_number(),chapter = cumsum(str_detect(text, regex("^ADVENTURE",ignore_case = TRUE)))) %>%
unnest_tokens(word,text)
tidy_book <- tidy_book %>%
anti_join(stop_words)
tidy_book
sentiments
nrcjoy <- get_sentiments("nrc")
nrcjoy
sentiment_book <- tidy_book %>%
left_join(nrcjoy)
sentiment_book
unique(sentiment_book$sentiment)
adventures <- read_lines("https://ia800501.us.archive.org/27/items/theadventuresofs01661gut/pg1661.txt", skip = 65) %>%
data_frame()
adventures
tidy_book <- adventures #%>%
tidy_book <- adventures %>%
data_frame(text=.) #%>%
adventures <- read_lines("https://ia800501.us.archive.org/27/items/theadventuresofs01661gut/pg1661.txt", skip = 65)
adventures
tidy_book <- adventures %>%
data_frame(text=.) #%>%
tidy_book
tidy_book <- adventures
data_frame(tidy_book,text=tidy_book)
tidy_book <- adventures %>%
data_frame(text=.) %>%
mutate(linenumber = row_number(),chapter = cumsum(str_detect(text, regex("^ADVENTURE",ignore_case = TRUE)))) #%>%
tidy_book
tidy_book <- adventures %>%
data_frame(text=.) %>%
mutate(linenumber = row_number(),chapter = cumsum(str_detect(text, regex("^ADVENTURE",ignore_case = TRUE)))) %>%
unnest_tokens(word,text)
tidy_book
data(stop_words)
stop_words
tidy_book <- tidy_book %>%
anti_join(stop_words)
tidy_book
nrcjoy <- get_sentiments("nrc")
nrcjoy
unique(nrcjoy$sentiment)
sentiment_book <- tidy_book %>%
left_join(nrcjoy)
sentiment_book
View(sentiment_book)
write.csv(sentiment_book,file = "~/Books_project/first_data.csv")
packages <- c("readr", "devtools","stringr", "tidyr", "tidytext","devtools")
for(i in packages) {
if(!require(i,character.only = TRUE)) install.packages(i)
library(i,character.only = TRUE)
}
rm(packages, i)
read_book <- function(link, skip_lines = 30){
book <- read_lines(link, skip = skip_lines)
return(book)
}
adventures <- read_lines("https://ia800501.us.archive.org/27/items/theadventuresofs01661gut/pg1661.txt", skip = 0)
adventures
link_adventures <- "https://ia800501.us.archive.org/27/items/theadventuresofs01661gut/pg1661.txt"
skip_lines <- 58
adventures <- read_book(link_adventures, skip = 58)
adventures
skip_lines <- 57
adventures <- read_book(link_adventures, skip_lines)
head(adventures)
tail(adventures,50)
tail(adventures,65)
tail(adventures,100)
tail(adventures,364)
read_book <- function(link, skip_init_lines = 30,skip_final_lines = 364){
book <- read_lines(link, skip = skip_init_lines) %>%
.[1:(length(.)-skip_final_lines)] %>%
na.omit()
return(book)
}
read_book(link_adventures)
adventures <- read_book(link_adventures, skip_init_lines,skip_final_lines)
skip_init_lines <- 57
skip_final_lines <- 364
adventures <- read_book(link_adventures, skip_init_lines,skip_final_lines)
adventures
tail_adventures
tail(adventures)
tail(adventures,10)
tidy_book <- function(book,chapter_regex){
tidy_book <- book %>%
data_frame(text=.) %>%
mutate(linenumber = row_number(), chapter = cumsum(str_detect(text, regex(chapter_regex,ignore_case = TRUE)))) %>%
unnest_tokens(word,text)
return(tidy_book)
}
tidy_book <- tidy_book(adventures, chapter_regex)
library(tidyr)
tidy_book <- tidy_book(adventures, chapter_regex)
packages <- c("readr", "devtools","stringr", "tidyr", "tidytext","devtools","dplyr")
for(i in packages) {
if(!require(i,character.only = TRUE)) install.packages(i)
library(i,character.only = TRUE)
}
rm(packages, i)
tidy_book <- tidy_book(adventures, chapter_regex)
chapter_regex <- "^ADVENTURE"
tidy_book <- tidy_book(adventures, chapter_regex)
tidy_book
stop_words
data(stop_words)
stop_words
tidy_book <- function(book,chapter_regex){
tidy_book <- book %>%
data_frame(text=.) %>%
mutate(linenumber = row_number(), chapter = cumsum(str_detect(text, regex(chapter_regex,ignore_case = TRUE)))) %>%
unnest_tokens(word,text) %>%
anti_join(stop_words)
return(tidy_book)
}
tidy_book <- tidy_book(adventures, chapter_regex)
tidy_book
sentiment_book <- add_sentiments(tidy_book,sentiment_dict)
add_sentiments <- function(tidy_book,sentiment_dict){
sentiments <- get_sentiments(sentiment_dict)
sentiment_book <- tidy_book %>%
left_join(sentiments)
return(sentiment_book)
}
sentiment_book <- add_sentiments(tidy_book,sentiment_dict)
sentiment_dict <- "nrc"
sentiment_book <- add_sentiments(tidy_book,sentiment_dict)
sentiment_word
sentiment_book
name <- "adventures_sherlock"
getwd()
getwd()[1]
getwd()[[1]]
paste(getwd(),"/",name,".csv")
write.csv(processed_book,file = paste(getwd(),"/",name,".csv",""))
paste(getwd(),"/",name,".csv","")
paste(getwd(),"/",name,".csv",separator="")
paste(getwd(),"/",name,".csv",sep="")
process_book <- function(link_adventures, skip_init_lines, skip_final_lines, chapter_regex, sentiment_dict, name){
processed_book <- read_book(link_adventures, skip_init_lines,skip_final_lines) %>%
tidy_book(chapter_regex) %>%
add_sentiments(sentiment_dict)
write.csv(processed_book,file = paste(getwd(),"/",name,".csv",sep=""))
}
processed_book <- process_book(link_adventures, skip_init_lines, skip_final_lines, chapter_regex, sentiment_dict, name)
tidy_book <- function(book,chapter_regex){
tidied_book <- book %>%
data_frame(text=.) %>%
mutate(linenumber = row_number(), chapter = cumsum(str_detect(text, regex(chapter_regex,ignore_case = TRUE)))) %>%
unnest_tokens(word,text) %>%
anti_join(stop_words)
return(tidied_book)
}
processed_book <- process_book(link_adventures, skip_init_lines, skip_final_lines, chapter_regex, sentiment_dict, name)
processed_book
process_book <- function(link_adventures, skip_init_lines, skip_final_lines, chapter_regex, sentiment_dict, name){
processed_book <- read_book(link_adventures, skip_init_lines,skip_final_lines) %>%
tidy_book(chapter_regex) %>%
add_sentiments(sentiment_dict)
write.csv(processed_book,file = paste(getwd(),"/",name,".csv",sep=""))
return(processed_book)
}
process_book
processed_book
processed_book <- process_book(link_adventures, skip_init_lines, skip_final_lines, chapter_regex, sentiment_dict, name)
processed_book
getwd()
link_flatland <- "http://www.gutenberg.org/cache/epub/97/pg97.txt"
section_regex <- "^SECTION"
flatland <- read_book(link_flatland, skip_init_lines,skip_final_lines)
flatland
skip_init_lines <- 60
tail(flatland)
skip_init_lines <- 60
name <- "flatland"
processed_flatland <- process_book(link_flatland, skip_init_lines, skip_final_lines, chapter_regex, sentiment_dict, name)
tidy_book <- function(book,chapter_regex){
tidied_book <- book %>%
data_frame(text=.) %>%
mutate(linenumber = row_number()) %>%
{if(chapter_regex != "") mutate(chapter = cumsum(str_detect(text, regex(chapter_regex,ignore_case = TRUE))))} %>%
unnest_tokens(word,text) %>%
anti_join(stop_words)
return(tidied_book)
}
tidied_book <- tidy_book(adventures, chapter_regex)
chapter_regex
tidy_book <- function(book,chapter_regex){
tidied_book <- book %>%
data_frame(text=.) %>%
mutate(linenumber = row_number()) %>%
{if(chapter_regex != "") mutate(chapter = cumsum(str_detect(text, regex(chapter_regex,ignore_case = TRUE))))} %>%
unnest_tokens(word,text) %>%
anti_join(stop_words)
return(tidied_book)
}
chapter_regex
tidied_book <- tidy_book(adventures, chapter_regex)
adventures <- read_book(link_adventures, skip_init_lines,skip_final_lines)
tidied_book <- adventures %>%
data_frame(text=.) %>%
mutate(linenumber = row_number()) %>%
{if(chapter_regex != "") mutate(chapter = cumsum(str_detect(text, regex(chapter_regex,ignore_case = TRUE))))} %>%
unnest_tokens(word,text) %>%
anti_join(stop_words)
tidied_book <- adventures %>%
data_frame(text=.) %>%
mutate(linenumber = row_number()) %>%
mutate(chapter = cumsum(str_detect(text, regex(chapter_regex,ignore_case = TRUE)))) %>%
unnest_tokens(word,text) %>%
anti_join(stop_words)
tidy_book <- function(book,chapter_regex){
tidied_book <- book %>%
data_frame(text=.) %>%
mutate(linenumber = row_number()) %>%
{if(chapter_regex != "") {mutate(chapter = cumsum(str_detect(text, regex(chapter_regex,ignore_case = TRUE))))}} %>%
unnest_tokens(word,text) %>%
anti_join(stop_words)
return(tidied_book)
}
tidied_book <- tidy_book(adventures, chapter_regex)
tidy_book <- function(book,chapter_regex){
tidied_book <- book %>%
data_frame(text=.) %>%
mutate(linenumber = row_number()) %>%
{ifelse(chapter_regex != "", mutate(chapter = cumsum(str_detect(text, regex(chapter_regex,ignore_case = TRUE)))),.)} %>%
unnest_tokens(word,text) %>%
anti_join(stop_words)
return(tidied_book)
}
tidied_book <- tidy_book(adventures, chapter_regex)
chapter_regex != ""
adventures
data_frame(adventures,text=adventures)
data_frame(text=adventures)
df <- data_frame(text=adventures)
first <- mutate(df,linenumber = row_number())
first
second <- mutate(first,chapter = cumsum(str_detect(text, regex(chapter_regex,ignore_case = TRUE))))
second
second <- ifelse(chapter_regex != "", mutate(chapter = cumsum(str_detect(text, regex(chapter_regex,ignore_case = TRUE)))),.)
second <- ifelse(chapter_regex != "", mutate(first,chapter = cumsum(str_detect(text, regex(chapter_regex,ignore_case = TRUE)))),.)
second
first
second <- ifelse(chapter_regex != "", mutate(first,chapter = cumsum(str_detect(text, regex(chapter_regex,ignore_case = TRUE)))),.)
second
first
text
second <- ifelse(chapter_regex != "", mutate(first,chapter = cumsum(str_detect(first$text, regex(chapter_regex,ignore_case = TRUE)))),.)
second
first
df
df
first
first$text
tidy_book <- function(book,chapter_regex){
tidied_book <- book %>%
data_frame(text=.) %>%
{ifelse(chapter_regex != "", mutate(chapter = cumsum(str_detect(text, regex(chapter_regex,ignore_case = TRUE)))),.)} %>%
mutate(linenumber = row_number()) %>%
unnest_tokens(word,text) %>%
anti_join(stop_words)
return(tidied_book)
}
tidied_book <- tidy_book(adventures, chapter_regex)
tidy_book <- function(book,chapter_regex){
tidied_book <- book %>%
data_frame(text=.) %>%
{ifelse(chapter_regex != "", mutate(.,chapter = cumsum(str_detect(text, regex(chapter_regex,ignore_case = TRUE)))),.)} %>%
mutate(linenumber = row_number()) %>%
unnest_tokens(word,text) %>%
anti_join(stop_words)
return(tidied_book)
}
tidied_book <- tidy_book(adventures, chapter_regex)
tidy_book <- function(book,chapter_regex){
tidied_book <- book %>%
data_frame(text=.) %>%
{ifelse(chapter_regex != "", mutate(.,chapter = cumsum(str_detect(.$text, regex(chapter_regex,ignore_case = TRUE)))),.)} %>%
mutate(linenumber = row_number()) %>%
unnest_tokens(word,text) %>%
anti_join(stop_words)
return(tidied_book)
}
tidied_book <- tidy_book(adventures, chapter_regex)
mutate(df,chapter = cumsum(str_detect(df$text, regex(chapter_regex,ignore_case = TRUE))))
ifelse(chapter_regex != "", mutate(df,chapter = cumsum(str_detect(df$text, regex(chapter_regex,ignore_case = TRUE)))),.)
if(chapter_regex != "") mutate(df,chapter = cumsum(str_detect(df$text, regex(chapter_regex,ignore_case = TRUE)))) else df
tidy_book <- function(book,chapter_regex){
tidied_book <- book %>%
data_frame(text=.) %>%
{if(chapter_regex != "") mutate(.,chapter = cumsum(str_detect(.$text, regex(chapter_regex,ignore_case = TRUE)))) else .} %>%
mutate(linenumber = row_number()) %>%
unnest_tokens(word,text) %>%
anti_join(stop_words)
return(tidied_book)
}
tidied_book <- tidy_book(adventures, chapter_regex)
tidied_book
chapter_regex = ""
tidied_book <- tidy_book(adventures, chapter_regex)
tidied_book
skip_final_lines <- 364
name <- "kant"
name <- "kafka"
skip_init_lines <- 57
chapter_regex <- ""
name <- "kafka"
adventures <- read_book(link_kafka, skip_init_lines,skip_final_lines)
link_kafka <- "http://www.gutenberg.org/cache/epub/5200/pg5200.txt"
adventures <- read_book(link_kafka, skip_init_lines,skip_final_lines)
adventures
skip_init_lines <- 30
adventures <- read_book(link_kafka, skip_init_lines,skip_final_lines)
head(adventures)
head(adventures,30)
skip_init_lines <- 43
adventures <- read_book(link_kafka, skip_init_lines,skip_final_lines)
head(adventures)
name <- "adventures_sherlock"
link_adventures <- "https://ia800501.us.archive.org/27/items/theadventuresofs01661gut/pg1661.txt"
skip_init_lines <- 57
skip_final_lines <- 364
chapter_regex <- "^ADVENTURE"
sentiment_dict <- "nrc"
name <- "adventures_sherlock"
link_adventures <- "https://ia800501.us.archive.org/27/items/theadventuresofs01661gut/pg1661.txt"
skip_init_lines <- 57
skip_final_lines <- 364
chapter_regex <- "^ADVENTURE"
sentiment_dict <- "nrc"
name <- "adventures_sherlock"
link_adventures <- "https://ia800501.us.archive.org/27/items/theadventuresofs01661gut/pg1661.txt"
skip_init_lines <- 57
skip_final_lines <- 364
chapter_regex <- "^ADVENTURE"
sentiment_dict <- "nrc"
processed_adventures <- process_book(link_adventures, skip_init_lines, skip_final_lines, chapter_regex, sentiment_dict, name)
name <- "flatland"
link_flatland <- "http://www.gutenberg.org/cache/epub/97/pg97.txt"
chapter_regex <- "^SECTION"
skip_init_lines <- 60
processed_flatland <- process_book(link_flatland, skip_init_lines, skip_final_lines, chapter_regex, sentiment_dict, name)
name <- "kant"
link_kant <- "https://www.gutenberg.org/files/4280/4280-0.txt"
skip_init_lines <- 2000
chapter_regex <- ""
processed_kant <- process_book(link_kant, skip_init_lines, skip_final_lines, chapter_regex, sentiment_dict, name)
name <- "kafka"
link_kafka <- "http://www.gutenberg.org/cache/epub/5200/pg5200.txt"
skip_init_lines <- 43
chapter_regex <- ""
processed_kant <- process_book(link_kafka, skip_init_lines, skip_final_lines, chapter_regex, sentiment_dict, name)
getwd()
setwd(getSrcDirectory()[1])
current_path <- getActiveDocumentContext()$path
library(rstudioapi)
current_path <- getActiveDocumentContext()$path
current_path
set_wd <- function() {
library(rstudioapi) # make sure you have it installed
current_path <- getActiveDocumentContext()$path
setwd(dirname(current_path ))
print( getwd() )
}
set_wd
set_wd()
current_path <- getActiveDocumentContext()$path
current_path
getActiveDocumentContext()
source('~/Visualizing-Books/02_Analysis/first_draft.R', echo=TRUE)
getwd()
source('~/Visualizing-Books/02_Analysis/first_draft.R', echo=TRUE)
source('~/Visualizing-Books/02_Analysis/first_draft.R', echo=TRUE)
